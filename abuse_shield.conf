# Nginx Abuse Shield Configuration
# Location: /etc/nginx/abuse_shield/abuse_shield.conf

# Log files to analyze (space-separated)
# IMPORTANT: Ensure your Nginx uses a custom log format starting with $msec
LOG_FILES="/var/log/nginx/concise.log /var/log/nginx/concise.log.1"

# Time window for analysis in seconds (default: 3000s = 50 mins)
TIME_WINDOW=3000

# How deep to check IP prefixes (2 = /16, 3 = /24)
IP_PARTS=2

# File locations
OUTPUT_FILE="/etc/nginx/abuse_shield/offending_ips.conf"
LOG_OUTPUT="/var/log/abuse-shield.log"

# Threshold Tuning
# THRESH_IP = TIME_WINDOW / THRESH_IP_DIV
THRESH_IP_DIV=2

# THRESH_3PART = (THRESH_3PART_NUM * TIME_WINDOW) / THRESH_3PART_DEN
THRESH_3PART_NUM=2
THRESH_3PART_DEN=3

# THRESH_2PART = (THRESH_2PART_NUM * TIME_WINDOW) / THRESH_2PART_DEN
THRESH_2PART_NUM=5
THRESH_2PART_DEN=6
